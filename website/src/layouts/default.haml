!!! 5{:itemscope, :itemtype => "http://schema.org/LocalBusiness"}
/ paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/
/[if lt IE 7]
  %html{:class => "no-js lt-ie9 lt-ie8 lt-ie7", :lang => "en"}
/[if IE 7]
  %html{:class => "no-js lt-ie9 lt-ie8", :lang => "en"}
/[if IE 8]
  %html{:class => "no-js lt-ie9", :lang => "en"}
/ Consider adding a manifest.appcache: h5bp.com/d/Offline -->
/[if gt IE 8]
  %html{:class => "no-js", :lang => "en", :itemscope, :itemtype => "http://schema.org/LocalBusiness"}

%head
  %meta{:charset => "utf-8"}
  %meta{:name => "google-site-verification", :content => "jdLTywbexVH-8P7WmQp_agAuQGsl84-3bwwHwlrAtbs"}
  %meta{:name => "verify-v1", :content => "Mn4HP1CuzeMuTt3AIDZiBOhx9QSkzo2pDByQ1HaTMKk="}

  /
    Use the .htaccess and remove these lines to avoid edge case issues.
    More info: h5bp.com/i/378
  %meta{"http-equiv" => "X-UA-Compatible", :content => "IE=edge,chrome=1"}

  %meta{:name => "keywords", :content => "#{keywords}"}
  %meta{:itemprop => "name", :content => "Advisicon"}
  %meta{:name => "description", :itemprop => "description", :content => "#{description}"}
  %meta{:content => "#{author}", :name => "author"}

  %title{"#{title} | Advisicon"}

  / Mobile viewport optimized: h5bp.com/viewport
  %meta{:name => "viewport", :content => "width=device-width"}

  / Place favicon.ico and apple-touch-icon.png in the root directory: mathiasbynens.be/notes/touch-icons

  %link{:rel => "stylesheet", :href => "/styles/css/style.css"}

  /
    More ideas for your <head> here: h5bp.com/d/head-Tips
  /
    All JavaScript at the bottom, except this Modernizr build.
    Modernizr enables HTML5 elements & feature detects for optimal performance.
    Create your own custom Modernizr build: www.modernizr.com/download/
  %script{:src => "/js/libs/modernizr-2.5.3.min.js"}
  %script{:src => "/js/libs/css3-mediaqueries.js"}

%body
  / Prompt IE 6 users to install Chrome Frame. Remove this if you support IE 6.
  / chromium.org/developers/how-tos/chrome-frame-getting-started
  /[if lt IE 8]
    %p.chromeframe
      :maruku
        Your browser is _ancient!_ [Upgrade to a different browser](http://browsehappy.com/) or [install Google Chrome Frame](http://www.google.com/chromeframe/?redirect=true) to experience this site.
  %header
    // nothing is in here

  %div{:role => "main"}

    #content

      %img{:border =>"0", :src => "/images/advisicon_banner-012709.jpg", :alt => "Advisicon, Inc.", :id => "advisiconBanner", :width => "950", :height => "110", :usemap => "#Map"}
      .navbar
        %nav#mainNavigation
          %a#homepage{:href => "/", :title => "Advisicon main page"}Home
          %a#about{:href => "/aboutus.htm", :title => "about Advisicon"}About Us
          %a#contactUs{:href => "/contactus.htm", :title => "contact Adviscion"}Contact Us
          %a#blog{:href => "http://www.advisiconblog.com", :title => "Advisicon blog", :target => "_blank"}Blog
          %a#advisiconStore{:href => "http://store.advisicon.com", :title => "Advisicon store", :target => "_blank"}Store
          %a#advisiconJobs{:href => "/careers.htm", :title => "careers at Advisicon"}Careers
          %a#advisiconMexico{:href => "http://www.advisicon.com.mx/", :title => "go to the site for our Mexico branch", :onclick => "MM_openBrWindow('http://www.advisicon.com.mx','','')"}Advisicon Mexico
          %a#callUs.tel{:href => "tel:+1-866-362-3847", :title => "call us at 1-866-362-3847", :onclick => "_gaq.push(['_trackEvent', 'Phone Calls', 'Headquarters', 'Toll Free']);"}1.866.36.ADVIS
        #accordianAds    
          %ul.accordion1
            %li.five
              %img{:border => "0", :src => "/pix/slide5.jpg", :alt => "We offer custom Application Development", :usemap => "#slide5"}
            %li.two
              %img{:border => "0", :src => "/pix/slide4.jpg", :alt => "We offer comprehensive Training programs", :usemap => "#slide4"}
          </li>
          <li class="one">
            <img border="0"  src="pix/slide3.jpg" alt="We specialize in SharePoint" usemap="#slide3"/>
          </li>
          <li class="three">
            <img border="0"  src="pix/slide2.jpg" alt="We can set up Microsoft Project and Microsoft Project Server" usemap="#slide2"/>
          </li>
          <li class="four">
            <img border="0"  src="pix/slide1.jpg" alt="We deliver project, program, and portfolio management consulting services" usemap="#slide1"/>
            <map name="slide1" id="slide1">
              <area shape="rect" coords="303,203,399,245" href="/project-management.htm" alt="project management slide" />
            </map>
            <map name="slide2" id="slide2">
              <area shape="rect" coords="331,187,427,229" href="/microsoft-project-office.htm" alt="microsoft project office slide" />
            </map>
            <map name="slide3" id="slide3">
              <area shape="rect" coords="341,208,437,250" href="/sharepoint.htm" alt="sharepoint slide" />
            </map>
            <map name="slide4" id="slide4">
              <area shape="rect" coords="341,206,437,248" href="/training.htm" alt="training slide" />
            </map>
            <map name="slide5" id="slide5">
              <area shape="rect" coords="302,195,398,237" href="/application_development.htm" alt="application development slide" />
            </map>
          </li> 
        </ul> <!-- END accordion1 -->
      </div> <!-- END accordionAds -->
    </div> <!-- END .navbar -->

      -# -------------------------BEGIN INSERTED PAGE CONTENT ---------------------------
      %section#content
        =yield
      -# -------------------------END PAGE CONTENT --------------------------------------
      aside#secondaryContent
        #navAndCred
          %nav#secondaryNav
            %a.secondaryNavButton{:href => "/case-studies.htm", :title => "see case studies"}Case Studies
            %a.secondaryNavButton{:href => "/clients.htm", :title => "see our clients"}Clients
            %a.secondaryNavButton{:href => "/partners.htm", :title => "see our partners"}Partners
            %a.secondaryNavButton{:href => "/training.htm", :title => "view our training offerings"}Training
            %a.secondaryNavButton{:href => "http://store.advisicon.com", :title => "shop our products in our store"}Store
            %a.secondaryNavButton.longText{:href => "/professional-associations.htm", :title => "see our professional associations"}Professional Associations
            %a.secondaryNavButton{:href => "/news.htm", :title => "Advisicon news and events"}News &amp; Events
            %a.secondaryNavButton.highlightedNavButton{:href => "/public_classes.htm", :title => "view our public class schedule"}Advisicon Public Class Schedule
            %a.secondaryNavButton.highlightedNavButton{:href => "/contactus.htm", :title => "view our contact info"}Contact Us!
          %ul#credentials
            %li
              %a{:href => "/staff_bios/tim-runcie.htm", :title => "Learn more about Advisicon&rsquo;s President, Tim Runcie, a Microsoft MVP"}
                %img{:border => "0", :src => "/pix/MVP_Horizontal_FullColor-small.jpg", :alt => "Microsoft MVP", :width => "150", :height =>"53"}
            %li
              %a{:href => "/our-certifications.htm", :title => "Learn more about our competencies as a Microsoft Certified Partner"}
                %img{:border => "0", :src => "/pix/AdvisiconPartnersLogo.png", :alt => "Microsoft Certified Gold Partner in Project and Portfolio Management, Silver Partner in Midmarket Solution Provider", :width => "150", :height => "52"}
            %li>
              %img{:border => "0", :src => "/pix/REPlogo.gif", :alt => "Project Management Institute / Registered Education Provider", :width => "150"}
        #socialProfiles.rPopBox
          %h3 Follow Us At
          %ul.otherCommsList
            %li
              %a{:target => "_blank", :href => "http://twitter.com/Advisicon"}
                %img{:border => "0", :src => "/pix/twitter.png", :alt => "Advisicon on Twitter", :width => "40", :height => "40", :title => "Twitter", :onclick => "_gaq.push(['_trackEvent', 'Twitter', 'User: Advisicon', 'User stream']);"}
            %li
              %a{:target => "_blank", :href => "http://www.linkedin.com/companies/advisicon"}
                %img{:border => "0",  :src > "/pix/linkedinicon.png", :alt => "Advisicon on LinkedIn", :width => "40", :height => "40", :title => "LinkedIn", :onclick => "_gaq.push(['_trackEvent', 'LinkedIn', 'User: Advisicon', 'Company Profile']);"}
            %li
              %a{:target => "_blank", :href => "http://www.facebook.com/Advisicon/"}
                %img{:border => "0",  :src => "/pix/facebook.png", :alt => "Advisicon on facebook", :width => "40", :height => "40", :title => "Facebook", :onclick => "_gaq.push(['_trackEvent', 'Facebook', 'User: Advisicon', 'Fan Page']);"}
            %li
              .g-plusone
              / <g:plusone></g:plusone>
              /
                ALERT: gotta troubleshoot this. Validator is giving me the following error:
                
                Unsafe JavaScript attempt to access frame with URL http://www.advisicon.com/ from frame with URL https://plusone.google.com/_/+1/fastbutton?url=http%3A%2F%2Fwww.advisicon.com%2F&size=standard&count=true&annotation=&hl=en-US&jsh=m%3B%2F_%2Fapps-static%2F_%2Fjs%2Fwidget%2F__features__%2Frt%3Dj%2Fver%3DTrdcjlW0oPo.en_US.%2Fsv%3D1%2Fam%3D!W_gXXLnZrrYgVlks%2Fd%3D1%2F#id=I1_1321645173676&parent=http%3A%2F%2Fwww.advisicon.com&rpctoken=191793283&_methods=onPlusOne%2C_ready%2C_close%2C_open%2C_resizeMe. Domains, protocols and ports must match.
                
                Button does not load in iPhone 3G Safari browser or the iPhone 3G Opera Mini browser.
                
                Note to Jeff: check loading on mobile browsers now

        .rPopBox
          %h3 Recent Blog Posts
          %ul#feedContent
              %li 
                Visit the 
                %a{:href => "http://blog.advisicon.com/", :title => "view the Advisicon blog"}Advisicon blog
                to see our most recent blog posts.
        .rPopBox
          %h3 Featured Tool
          %ul
            %li{:itemscope => true, :itemtype => "http://schema.org/Product"}
              %a{:href => "/MSP_Rex.htm", :itemprop => "name url"}MSP-Rex
              (
              %span{:itemprop => "description"}Report Extractor
              )
        .rPopBox
          %h3 News &amp; Events
          %ul
            /
              <%
              sub process_html(up_http) 
                dim xmlhttp : set xmlhttp = createobject("msxml2.xmlhttp.3.0")
                xmlhttp.open "get", up_http, false
                xmlhttp.send
                
                dim response_array : response_array = split(xmlhttp.responseText, "<item>")
                
                dim re : Set re = new regexp 'defines the variable re and makes it a new regular expression
                  re.Pattern = "<title>.*</title>" 'set up a regular expression to use for searching the items in our array. We're using it to search for the title tags.
                  re.IgnoreCase = True 'regular expression search is case insensitive. Don't know why we can't just do this in the regexp itself.
                  re.Global = True 'makes sure match applies to the entire string
                
                dim i 'declare a new variable, i. We'll use this to step through the items in the array
                for i = 1 to ubound(response_array) 'steps through the items in the array, starting at the position response_array(1) and continuing to the end of response_array. ubound seems to act a bit like .length, len(), etc. We start at position 1 instead of 0 so that we don't pick up matches from the stuff in the <channel> before the first <item>
                  if re.Test(response_array(i)) then 'if the regular expression pattern defined earlier as re is found within the array item then do the following. re.Test() returns a boolean.
                    Set Matches = re.Execute(response_array(i)) 'make a new array, this one called Matches. Created from the current item in response_array.
                    for each Match in Matches 'for each item in this new Matches array ...
                      title = Replace(Match.Value,"<title>","") 'remove the opening <title>
                      title = Replace(title,"</title>","") 'remove the closing </title> tag
                      dim reLink : Set reLink = new regexp 'new regular expression, this one is called reLink. We'll use it to search for the <link> tags
                        reLink.Pattern = "<link>.*</link>" 'looking for the <link> tags
                        reLink.IgnoreCase = True 'case insensitive
                        reLink.Global = True 'search entire string
                        Set linkMatches = reLink.Execute(response_array(i)) 'make a new array called linkMatches from the current item in response_array()
                          for each linkMatch in linkMatches
                            link = Replace(linkMatch.Value,"<link>","") 'remove the opening <link>
                            link = Replace(link,"</link>", "") 'remove the closing </link>
                          Next
                      response.write("<li><a href='" & link & "' title='read the full article, &ldquo;" & title & "&rdquo; on the blog'>" & title & "</a></li>") 'build a header for this news/event item
                    Next
                  else
                    response.write("<p>I couldn't find anything.</p>")
                  end if
                next 'use a for loop to use the regular expression on the array. The output from the loop will be the line(s) containing the search pattern
                
                set re = nothing
                set xmlhttp = nothing
                set responce_array = nothing
                set i = nothing
                set Matches = nothing
                set Match = nothing
                set title = nothing
                set reLink = nothing
                set linkMatches = nothing
                set link = nothing
                
              end sub 'free up any memory used by the process
              
              process_html("http://blog.advisicon.com/tag/event/feed/") 'point the subprocess to the webpage you want to access
              %>
        .rPopBox#featuredBooks
          %h3 Featured Books
          %ul#portfolio 
            / These books are OLD
            /
              <li>
                <a   href="http://store.advisicon.com/products/microsoft-office-project-server-2007-administrators-guide">
                  <img border="0"  src="/pix/Cover-MOPSAdmin.jpg" alt="Microsoft Office Project Server - Administrator's Guide" width="150" height="195" />
                </a>
              </li>
              <li>
                <a  href="http://store.advisicon.com/products/microsoft-office-project-server-2007-project-managers-guide">
                  <img border="0"  src="/pix/Cover-MOPSProjManager.jpg" alt="Microsoft Office Project Server - Project Manager's Guide" width="150" height="195" />
                </a>
              </li> 
              <li>
                <a  href="http://store.advisicon.com/products/microsoft-office-project-server-2007-reporting-analysis-guide">
                  <img border="0"  src="/pix/Cover-MOPSRepAnalysis.jpg" alt="Microsoft Office Project Server - Reporting and Analysis Guide" width="150" height="195" />
                </a>
              </li> 
              <li>
                <a  href="http://store.advisicon.com/products/microsoft-office-project-server-2007-team-members-guide">
                  <img border="0"  src="/pix/Cover-MOPSTeamMember.jpg" alt="Microsoft Office Project Server - Team Member's Guide" width="150" height="195" />
                </a>
              </li> 
              <li>
                <a  href="http://store.advisicon.com/products/managing-projects-with-microsoft-project-2007-best-practices-in-managing-projects-with-microsoft-project">
                  <img border="0"  src="/pix/Cover-MPwMSP.jpg" alt="Managing Projects with Microsoft Project" width="150" height="195" />
                </a>
              </li>
              <li>
                <a  href="http://store.advisicon.com/products/mastering-requirements-gathering-best-practices-in-managing-project-requirements">
                  <img border="0"  src="/pix/Cover-MRG.jpg" alt="Mastering Requirements Gathering" width="150" height="195" />
                </a>
              </li>
              <li>                    
                <a  href="http://store.advisicon.com/products/practical-project-management-best-practices-and-tools-for-managing-projects-effectively">
                  <img border="0"  src="/pix/Cover-PPM.jpg" alt="Practical Project Management" width="150" height="195" />
                </a>
              </li>
              <li>
                <a  href="http://store.advisicon.com/products/sharepoint-for-effective-project-management-2007-how-project-teams-can-collaborate-with-sharepoint">
                  <img border="0"  src="/pix/Cover-SharePoint.jpg" alt="SharePoint for Effective Project Management" width="150" height="195" />
                </a>
              </li>
            %li
              %a{:href => "http://store.advisicon.com/products/microsoft-access-in-a-sharepoint-world"}
                %img{:border => "0", :src => "/pix/Cover-MASW.jpg", :alt => "Microsoft Access in a SharePoint World", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/microsoft-business-intelligence-building-executive-dashboards-with-sharepoint-2010"}
                %img{:border => "0", :src => "/pix/Cover-BI-thumb.png", :alt => "Microsoft Business Intelligence", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/microsoft-project-server-2010-administrators-guide"}
                %img{:border => "0", :src => "/pix/Cover-MSPS2010-Admin.jpg", :alt => "Microsoft Project Server 2010&nbsp;&ndash; Administrator&rsquo;s Guide", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/microsoft-project-server-2010-project-managers-guide"}
                %img{:border => "0", :src => "/pix/Cover-MSPS2010-PM.jpg", :alt => "Microsoft Project Server 2010&nbsp;&ndash; Project Manager&rsquo;s Guide", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/microsoft-project-server-2010-team-members-guide"}
                %img{:border => "0", :src => "/pix/Cover-MSPS2010-TM.jpg", :alt => "Microsoft Project Server 2010&nbsp;&ndash; Team Member&rsquo;s Guide", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/managing-projects-with-microsoft-project-2010-best-practices-in-managing-projects-with-microsoft-project"}
                %img{:border => "0", :src => "/pix/Cover-MPWMSP2010.jpg", :alt => "Managing Projects with Microsoft Project 2010", :width => "150", :height => "195"}
            %li
              %a{:href => "http://store.advisicon.com/products/sharepoint-for-effective-team-collaboration-2010"}
                %img{:border => "0", :src => "/pix/Cover-SPfETC-thumb.jpg", :alt => "SharePoint for Effective Team Collaboration" width="150" height="195"}
          %p Click a book for more information

      -# -------------------------BEGIN INSERTED PAGE CONTENT ---------------------------
      %section#main 
        =yield
      -# -------------------------END PAGE CONTENT --------------------------------------
  %footer
    #footer
      %table.navbartemp
        %tr
          %td
      %img{:border => "0", :src => "/pix/footer_bar.jpg", :alt => "footer background", :width => "950", :height => "14"}
    #nav
      %ul.navbarmini
        %li
          %a{:href => "/site_map.htm", :title => "view the site map"}Site Map
        %li
          %a{:href => "/privacy-policy.htm", :title => "view our privacy policy"}Privacy Policy
        %li
          %a.tel{:href => "tel:+1-866-362-3847", :title => "call us at 1-866-362-3847", :onclick => "_gaq.push(['_trackEvent', 'Phone Calls', 'Headquarters', 'Toll Free']);"}1.866.36.ADVIS

  %map#Map{:name => "Map"}
    %area{:shape => "rect", :coords => "858,21,936,99", :href => "/", :alt => "Advisicon Home"}
    %area{:shape => "rect", :coords => "860,22,861,24", :href =>"#", :alt => "Advisicon"}



  -# ---------------- JavaScript at the bottom for fast page loading ---------------------

  // Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline
  %script{:src => "//ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"}
  :javascript
    window.jQuery || document.write('<script src="js/libs/jquery-1.6.0.min.js"><\/script>')

  // scripts concatenated and minified via build script
  %script{:src => "/js/plugins.js"}
  %script{:src => "/js/script.js"}

  // Script for loading the google feed API
  %script{:src => "https://www.google.com/jsapi", :type => "text/javascript"}

  // loads the Advisicon blog feed
  %script{:src => "/Scripts/loadGoogleFeed.js", :type => "text/javascript"}

  // loads tweets
  %script{:src => "/Scripts/twitter.js", :type => "text/javascript"}

  // I believe this is for animating the slides in that (ridiculous) header
  %script{:src => "/jscript/jquery.easing.1.3.js", :type => "text/javascript"}

  // Part of the slide control in the header
  %script{:src => "/jscript/2/jquery.hslides.js", :type => "text/javascript"}

  / 
    Not really sure why we are using this. Doesn't seem to apply to anything we've got going on this page at the moment. Likely useless.
    <script src="jscript/2/jquery.hoverintent.js" type="text/javascript"></script>
  // Animates the fade in/fade out of book in the "Featured Books section"
  %script{:src => "/jscript/2/jquery.innerfade.js", :type => "text/javascript"}

  // Controls the display of that silly banner at the top of the index page. It sizes all of the slides the same [Jeff]
  %script{:src => "/Scripts/frontPageSlideshowHeader.js", :type => "text/javascript"}

  // Controls the slideshow action of fading from book to book in the "Featured Books" section of the index page [Jeff]
  %script{:src => "/Scripts/featuredProducts.js", :type => "text/javascript"}

  // Render call for the google +1 link [Jeff]
  %script{:src =>"/Scripts/googlePlusOneButton.js", :type => "text/javascript"}

  / 
    Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
    mathiasbynens.be/notes/async-analytics-snippet -->
  %script{:src="/Scripts/rootGoogleAnalytics.js", :type => "text/javascript"}

  -# ------------------- end scripts --------------------------------------------------------
